{"ast":null,"code":"import _objectSpread from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/user/Documents/projects/hollaex/src/containers/UserSettings/index.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { SubmissionError } from 'redux-form';\nimport { isMobile } from 'react-device-detect';\nimport { browserHistory } from 'react-router';\nimport { setLanguage, changeTheme, openContactForm, openRiskPortfolioOrderWarning, closeNotification } from '../../actions/appActions';\nimport { logout } from '../../actions/authAction';\nimport { updateUser, setUserData, setUsername, setUsernameStore } from '../../actions/userAction';\nimport { IconTitle, HeaderSection, CustomTabs, CustomMobileTabs, CustomTabBar, MobileTabBar, Loader } from '../../components';\nimport SettingsForm, { generateFormValues } from './SettingsForm';\nimport UsernameForm, { generateUsernameFormValues } from './UsernameForm';\nimport LanguageForm, { generateLanguageFormValues } from './LanguageForm';\nimport NotificationForm, { generateNotificationFormValues } from './NotificationForm';\nimport AudioCueForm, { generateAudioCueFormValues } from './AudioForm';\nimport RiskForm, { generateWarningFormValues } from './RiskForm';\nimport STRINGS from '../../config/localizedStrings';\nimport { ICONS } from '../../config/constants';\nimport { calculateBalancePrice } from '../../utils/currency';\n\nvar UserSettings =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(UserSettings, _Component);\n\n  function UserSettings() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, UserSettings);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(UserSettings)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      sections: [],\n      tabs: [],\n      dialogIsOpen: false,\n      modalText: '',\n      activeTab: 0,\n      totalAssets: ''\n    };\n\n    _this.onAdjustPortfolio = function () {\n      _this.props.openRiskPortfolioOrderWarning({\n        onSubmit: function onSubmit(formProps) {\n          return _this.onSubmitSettings(formProps, 'risk');\n        },\n        initialValues: _this.props.settings.risk\n      });\n    };\n\n    _this.calculateSections = function (_ref) {\n      var balance = _ref.balance,\n          prices = _ref.prices;\n      var totalAssets = calculateBalancePrice(balance, prices);\n\n      _this.setState({\n        totalAssets: totalAssets\n      });\n    };\n\n    _this.updateTabs = function (_ref2, activeTab) {\n      var _ref2$username = _ref2.username,\n          username = _ref2$username === void 0 ? '' : _ref2$username,\n          _ref2$settings = _ref2.settings,\n          settings = _ref2$settings === void 0 ? {} : _ref2$settings,\n          _ref2$coins = _ref2.coins,\n          coins = _ref2$coins === void 0 ? {} : _ref2$coins;\n      var formValues = generateFormValues({});\n      var usernameFormValues = generateUsernameFormValues(settings.chat.set_username);\n      var languageFormValue = generateLanguageFormValues();\n      var notificationFormValues = generateNotificationFormValues();\n      var audioFormValues = generateAudioCueFormValues();\n      var warningFormValues = generateWarningFormValues();\n      var tabs = [{\n        title: isMobile ? React.createElement(CustomMobileTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_NOTIFICATION,\n          icon: ICONS.SETTING_NOTIFICATION_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }) : React.createElement(CustomTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_NOTIFICATION,\n          icon: ICONS.SETTING_NOTIFICATION_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }),\n        content: activeTab === 0 && React.createElement(NotificationForm, {\n          onSubmit: function onSubmit(formProps) {\n            return _this.onSubmitSettings(formProps, 'notification');\n          },\n          formFields: notificationFormValues,\n          initialValues: settings.notification,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        })\n      }, {\n        title: isMobile ? React.createElement(CustomMobileTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_INTERFACE,\n          icon: ICONS.SETTING_INTERFACE_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }) : React.createElement(CustomTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_INTERFACE,\n          icon: ICONS.SETTING_INTERFACE_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        }),\n        content: activeTab === 1 && React.createElement(SettingsForm, {\n          onSubmit: function onSubmit(formProps) {\n            return _this.onSubmitSettings(formProps, 'interface');\n          },\n          formFields: formValues,\n          initialValues: settings.interface,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        })\n      }, {\n        title: isMobile ? React.createElement(CustomMobileTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_LANGUAGE,\n          icon: ICONS.SETTING_LANGUAGE_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        }) : React.createElement(CustomTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_LANGUAGE,\n          icon: ICONS.SETTING_LANGUAGE_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189\n          },\n          __self: this\n        }),\n        content: activeTab === 2 && React.createElement(LanguageForm, {\n          onSubmit: function onSubmit(formProps) {\n            return _this.onSubmitSettings(formProps, 'language');\n          },\n          formFields: languageFormValue,\n          initialValues: settings,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        })\n      }, {\n        title: isMobile ? React.createElement(CustomMobileTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_CHAT,\n          icon: ICONS.SETTING_CHAT_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }) : React.createElement(CustomTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_CHAT,\n          icon: ICONS.SETTING_CHAT_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 211\n          },\n          __self: this\n        }),\n        content: activeTab === 3 && React.createElement(UsernameForm, {\n          onSubmit: _this.onSubmitUsername,\n          formFields: usernameFormValues,\n          initialValues: {\n            username: username\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        })\n      }, {\n        title: isMobile ? React.createElement(CustomMobileTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_AUDIO_CUE,\n          icon: ICONS.SETTING_AUDIO_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226\n          },\n          __self: this\n        }) : React.createElement(CustomTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_AUDIO_CUE,\n          icon: ICONS.SETTING_AUDIO_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 231\n          },\n          __self: this\n        }),\n        content: activeTab === 4 && React.createElement(AudioCueForm, {\n          onSubmit: function onSubmit(formProps) {\n            return _this.onSubmitSettings(formProps, 'audio');\n          },\n          formFields: audioFormValues,\n          initialValues: settings.audio,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 237\n          },\n          __self: this\n        })\n      }, {\n        title: isMobile ? React.createElement(CustomMobileTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_MANAGE_RISK,\n          icon: ICONS.SETTING_RISK_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 248\n          },\n          __self: this\n        }) : React.createElement(CustomTabs, {\n          title: STRINGS.USER_SETTINGS.TITLE_MANAGE_RISK,\n          icon: ICONS.SETTING_RISK_ICON,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 253\n          },\n          __self: this\n        }),\n        content: activeTab === 5 && React.createElement(RiskForm, {\n          coins: coins,\n          onAdjustPortfolio: _this.onAdjustPortfolio,\n          totalAssets: _this.state.totalAssets,\n          onSubmit: function onSubmit(formProps) {\n            return _this.onSubmitSettings(formProps, 'risk');\n          },\n          formFields: warningFormValues,\n          initialValues: settings.risk,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 259\n          },\n          __self: this\n        })\n      }];\n\n      _this.setState({\n        tabs: tabs\n      });\n    };\n\n    _this.renderContent = function (tabs, activeTab) {\n      return tabs[activeTab] && tabs[activeTab].content ? tabs[activeTab].content : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280\n        },\n        __self: this\n      });\n    };\n\n    _this.onSubmitSettings = function (formProps, formKey) {\n      var settings = {};\n\n      switch (formKey) {\n        case 'notification':\n          settings.notification = formProps;\n          break;\n\n        case 'interface':\n          settings = _objectSpread({}, formProps); // ToDo: need to be removed after end point update\n\n          settings.interface = formProps;\n          break;\n\n        case 'language':\n          settings = _objectSpread({}, formProps);\n          break;\n\n        case 'chat':\n          settings.chat = _objectSpread({}, formProps);\n          break;\n\n        case 'audio':\n          settings.audio = formProps;\n          break;\n\n        case 'risk':\n          settings.risk = formProps;\n          break;\n\n        default:\n      }\n\n      return updateUser({\n        settings: settings\n      }).then(function (_ref3) {\n        var data = _ref3.data;\n\n        _this.props.setUserData(data);\n\n        _this.props.changeLanguage(data.settings.language);\n\n        _this.props.changeTheme(data.settings.interface.theme);\n\n        _this.props.closeNotification();\n\n        localStorage.setItem('theme', data.settings.interface.theme);\n      }).catch(function (err) {\n        var _error = err.response && err.response.data ? err.response.data.message : err.message;\n\n        throw new SubmissionError({\n          _error: _error\n        });\n      });\n    };\n\n    _this.onSubmitUsername = function (values) {\n      return setUsername(values).then(function () {\n        _this.props.setUsernameStore(values.username);\n\n        _this.onSubmitSettings({\n          set_username: true\n        }, 'chat');\n      }).catch(function (err) {\n        var _error = err.response && err.response.data ? err.response.data.message : err.message;\n\n        throw new SubmissionError({\n          username: _error\n        });\n      });\n    };\n\n    _this.logout = function () {\n      var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n      _this.props.logout(typeof message === 'string' ? message : '');\n    };\n\n    _this.openContactForm = function () {\n      _this.props.openContactForm();\n    };\n\n    _this.setActiveTab = function (activeTab) {\n      _this.setState({\n        activeTab: activeTab\n      });\n\n      if (_this.props.location.query && _this.props.location.query.tab) {\n        _this.removeQueryString();\n      }\n    };\n\n    _this.removeQueryString = function () {\n      browserHistory.push('/settings');\n    };\n\n    return _this;\n  }\n\n  _createClass(UserSettings, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var user = this.props.user;\n\n      if (user.id) {\n        this.calculateSections(this.props);\n      }\n\n      if (this.props.location.query && this.props.location.query.tab) {\n        this.setState({\n          activeTab: parseInt(this.props.location.query.tab, 10)\n        }, function () {\n          _this2.updateTabs(_this2.props, _this2.state.activeTab);\n        });\n      } else {\n        this.updateTabs(this.props, this.state.activeTab);\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var _this3 = this;\n\n      if (nextProps.activeLanguage !== this.props.activeLanguage) {\n        this.updateTabs(this.props, this.state.activeTab);\n      }\n\n      if (JSON.stringify(this.props.settings) !== JSON.stringify(nextProps.settings)) {\n        this.updateTabs(nextProps, this.state.activeTab);\n      }\n\n      if (JSON.stringify(this.props.location.query) !== JSON.stringify(nextProps.location.query) && nextProps.location.query && nextProps.location.query.tab) {\n        this.setState({\n          activeTab: parseInt(nextProps.location.query.tab, 10)\n        }, function () {\n          _this3.updateTabs(nextProps, _this3.state.activeTab);\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUpdate\",\n    value: function componentWillUpdate(nextProps, nextState) {\n      if (nextProps.user.id !== this.props.user.id || nextProps.price !== this.props.price || nextProps.orders.length !== this.props.orders.length || nextProps.balance.timestamp !== this.props.balance.timestamp || nextProps.activeLanguage !== this.props.activeLanguage) {\n        this.calculateSections(nextProps);\n      }\n\n      if (this.state.activeTab !== nextState.activeTab && this.state.activeTab !== -1) {\n        this.updateTabs(nextProps, nextState.activeTab);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.props.verification_level === 0) {\n        return React.createElement(Loader, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 359\n          },\n          __self: this\n        });\n      }\n\n      var _this$state = this.state,\n          activeTab = _this$state.activeTab,\n          tabs = _this$state.tabs;\n      return React.createElement(\"div\", {\n        className: \"presentation_container apply_rtl verification_container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }, !isMobile && React.createElement(IconTitle, {\n        text: STRINGS.ACCOUNTS.TAB_SETTINGS,\n        textType: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 366\n        },\n        __self: this\n      }), React.createElement(HeaderSection, {\n        title: STRINGS.ACCOUNTS.TAB_SETTINGS,\n        openContactForm: this.openContactForm,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 371\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"header-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 375\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 376\n        },\n        __self: this\n      }, STRINGS.USER_SETTINGS.TITLE_TEXT_1), React.createElement(\"div\", {\n        className: \"mb-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 377\n        },\n        __self: this\n      }, STRINGS.USER_SETTINGS.TITLE_TEXT_2))), !isMobile ? React.createElement(CustomTabBar, {\n        activeTab: activeTab,\n        setActiveTab: this.setActiveTab,\n        tabs: tabs,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383\n        },\n        __self: this\n      }) : React.createElement(MobileTabBar, {\n        activeTab: activeTab,\n        renderContent: this.renderContent,\n        setActiveTab: this.setActiveTab,\n        tabs: tabs,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 389\n        },\n        __self: this\n      }), !isMobile ? this.renderContent(tabs, activeTab) : null, isMobile && React.createElement(\"div\", {\n        className: \"my-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 398\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return UserSettings;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    coins: state.app.coins,\n    verification_level: state.user.verification_level,\n    settings: state.user.settings,\n    username: state.user.username,\n    activeLanguage: state.app.language,\n    balance: state.user.balance,\n    prices: state.orderbook.prices,\n    user: state.user,\n    price: state.orderbook.price,\n    orders: state.order.activeOrders\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    setUsernameStore: bindActionCreators(setUsernameStore, dispatch),\n    setUserData: bindActionCreators(setUserData, dispatch),\n    changeLanguage: bindActionCreators(setLanguage, dispatch),\n    changeTheme: bindActionCreators(changeTheme, dispatch),\n    openContactForm: bindActionCreators(openContactForm, dispatch),\n    openRiskPortfolioOrderWarning: bindActionCreators(openRiskPortfolioOrderWarning, dispatch),\n    closeNotification: bindActionCreators(closeNotification, dispatch),\n    logout: bindActionCreators(logout, dispatch)\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserSettings);","map":{"version":3,"sources":["/home/user/Documents/projects/hollaex/src/containers/UserSettings/index.js"],"names":["React","Component","connect","bindActionCreators","SubmissionError","isMobile","browserHistory","setLanguage","changeTheme","openContactForm","openRiskPortfolioOrderWarning","closeNotification","logout","updateUser","setUserData","setUsername","setUsernameStore","IconTitle","HeaderSection","CustomTabs","CustomMobileTabs","CustomTabBar","MobileTabBar","Loader","SettingsForm","generateFormValues","UsernameForm","generateUsernameFormValues","LanguageForm","generateLanguageFormValues","NotificationForm","generateNotificationFormValues","AudioCueForm","generateAudioCueFormValues","RiskForm","generateWarningFormValues","STRINGS","ICONS","calculateBalancePrice","UserSettings","state","sections","tabs","dialogIsOpen","modalText","activeTab","totalAssets","onAdjustPortfolio","props","onSubmit","formProps","onSubmitSettings","initialValues","settings","risk","calculateSections","balance","prices","setState","updateTabs","username","coins","formValues","usernameFormValues","chat","set_username","languageFormValue","notificationFormValues","audioFormValues","warningFormValues","title","USER_SETTINGS","TITLE_NOTIFICATION","SETTING_NOTIFICATION_ICON","content","notification","TITLE_INTERFACE","SETTING_INTERFACE_ICON","interface","TITLE_LANGUAGE","SETTING_LANGUAGE_ICON","TITLE_CHAT","SETTING_CHAT_ICON","onSubmitUsername","TITLE_AUDIO_CUE","SETTING_AUDIO_ICON","audio","TITLE_MANAGE_RISK","SETTING_RISK_ICON","renderContent","formKey","then","data","changeLanguage","language","theme","localStorage","setItem","catch","err","_error","response","message","values","setActiveTab","location","query","tab","removeQueryString","push","user","id","parseInt","nextProps","activeLanguage","JSON","stringify","nextState","price","orders","length","timestamp","verification_level","ACCOUNTS","TAB_SETTINGS","TITLE_TEXT_1","TITLE_TEXT_2","mapStateToProps","app","orderbook","order","activeOrders","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { SubmissionError } from 'redux-form';\nimport { isMobile } from 'react-device-detect';\nimport { browserHistory } from 'react-router';\n\nimport {\n\tsetLanguage,\n\tchangeTheme,\n\topenContactForm,\n\topenRiskPortfolioOrderWarning,\n\tcloseNotification\n} from '../../actions/appActions';\nimport { logout } from '../../actions/authAction';\nimport {\n\tupdateUser,\n\tsetUserData,\n\tsetUsername,\n\tsetUsernameStore\n} from '../../actions/userAction';\nimport {\n\tIconTitle,\n\tHeaderSection,\n\tCustomTabs,\n\tCustomMobileTabs,\n\tCustomTabBar,\n\tMobileTabBar,\n\tLoader\n} from '../../components';\nimport SettingsForm, { generateFormValues } from './SettingsForm';\nimport UsernameForm, { generateUsernameFormValues } from './UsernameForm';\nimport LanguageForm, { generateLanguageFormValues } from './LanguageForm';\nimport NotificationForm, {\n\tgenerateNotificationFormValues\n} from './NotificationForm';\nimport AudioCueForm, { generateAudioCueFormValues } from './AudioForm';\nimport RiskForm, { generateWarningFormValues } from './RiskForm';\n\nimport STRINGS from '../../config/localizedStrings';\nimport { ICONS } from '../../config/constants';\nimport { calculateBalancePrice } from '../../utils/currency';\n\nclass UserSettings extends Component {\n\tstate = {\n\t\tsections: [],\n\t\ttabs: [],\n\t\tdialogIsOpen: false,\n\t\tmodalText: '',\n\t\tactiveTab: 0,\n\t\ttotalAssets: ''\n\t};\n\n\tcomponentDidMount() {\n\t\tconst { user } = this.props;\n\n\t\tif (user.id) {\n\t\t\tthis.calculateSections(this.props);\n\t\t}\n\t\tif (this.props.location.query && this.props.location.query.tab) {\n\t\t\tthis.setState(\n\t\t\t\t{ activeTab: parseInt(this.props.location.query.tab, 10) },\n\t\t\t\t() => {\n\t\t\t\t\tthis.updateTabs(this.props, this.state.activeTab);\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tthis.updateTabs(this.props, this.state.activeTab);\n\t\t}\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tif (nextProps.activeLanguage !== this.props.activeLanguage) {\n\t\t\tthis.updateTabs(this.props, this.state.activeTab);\n\t\t}\n\t\tif (\n\t\t\tJSON.stringify(this.props.settings) !==\n\t\t\tJSON.stringify(nextProps.settings)\n\t\t) {\n\t\t\tthis.updateTabs(nextProps, this.state.activeTab);\n\t\t}\n\t\tif (\n\t\t\tJSON.stringify(this.props.location.query) !==\n\t\t\t\tJSON.stringify(nextProps.location.query) &&\n\t\t\tnextProps.location.query &&\n\t\t\tnextProps.location.query.tab\n\t\t) {\n\t\t\tthis.setState(\n\t\t\t\t{ activeTab: parseInt(nextProps.location.query.tab, 10) },\n\t\t\t\t() => {\n\t\t\t\t\tthis.updateTabs(nextProps, this.state.activeTab);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tcomponentWillUpdate(nextProps, nextState) {\n\t\tif (\n\t\t\tnextProps.user.id !== this.props.user.id ||\n\t\t\tnextProps.price !== this.props.price ||\n\t\t\tnextProps.orders.length !== this.props.orders.length ||\n\t\t\tnextProps.balance.timestamp !== this.props.balance.timestamp ||\n\t\t\tnextProps.activeLanguage !== this.props.activeLanguage\n\t\t) {\n\t\t\tthis.calculateSections(nextProps);\n\t\t}\n\t\tif (\n\t\t\tthis.state.activeTab !== nextState.activeTab &&\n\t\t\tthis.state.activeTab !== -1\n\t\t) {\n\t\t\tthis.updateTabs(nextProps, nextState.activeTab);\n\t\t}\n\t}\n\n\tonAdjustPortfolio = () => {\n\t\tthis.props.openRiskPortfolioOrderWarning({\n\t\t\tonSubmit: (formProps) => this.onSubmitSettings(formProps, 'risk'),\n\t\t\tinitialValues: this.props.settings.risk\n\t\t});\n\t};\n\n\tcalculateSections = ({ balance, prices }) => {\n\t\tconst totalAssets = calculateBalancePrice(balance, prices);\n\t\tthis.setState({ totalAssets: totalAssets });\n\t};\n\n\tupdateTabs = ({ username = '', settings = {}, coins = {} }, activeTab) => {\n\t\tconst formValues = generateFormValues({});\n\t\tconst usernameFormValues = generateUsernameFormValues(\n\t\t\tsettings.chat.set_username\n\t\t);\n\t\tconst languageFormValue = generateLanguageFormValues();\n\t\tconst notificationFormValues = generateNotificationFormValues();\n\t\tconst audioFormValues = generateAudioCueFormValues();\n\t\tconst warningFormValues = generateWarningFormValues();\n\n\t\tconst tabs = [\n\t\t\t{\n\t\t\t\ttitle: isMobile ? (\n\t\t\t\t\t<CustomMobileTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_NOTIFICATION}\n\t\t\t\t\t\ticon={ICONS.SETTING_NOTIFICATION_ICON}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<CustomTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_NOTIFICATION}\n\t\t\t\t\t\ticon={ICONS.SETTING_NOTIFICATION_ICON}\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tcontent: activeTab === 0 && (\n\t\t\t\t\t<NotificationForm\n\t\t\t\t\t\tonSubmit={(formProps) =>\n\t\t\t\t\t\t\tthis.onSubmitSettings(formProps, 'notification')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tformFields={notificationFormValues}\n\t\t\t\t\t\tinitialValues={settings.notification}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: isMobile ? (\n\t\t\t\t\t<CustomMobileTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_INTERFACE}\n\t\t\t\t\t\ticon={ICONS.SETTING_INTERFACE_ICON}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<CustomTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_INTERFACE}\n\t\t\t\t\t\ticon={ICONS.SETTING_INTERFACE_ICON}\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tcontent: activeTab === 1 && (\n\t\t\t\t\t<SettingsForm\n\t\t\t\t\t\tonSubmit={(formProps) =>\n\t\t\t\t\t\t\tthis.onSubmitSettings(formProps, 'interface')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tformFields={formValues}\n\t\t\t\t\t\tinitialValues={settings.interface}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: isMobile ? (\n\t\t\t\t\t<CustomMobileTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_LANGUAGE}\n\t\t\t\t\t\ticon={ICONS.SETTING_LANGUAGE_ICON}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<CustomTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_LANGUAGE}\n\t\t\t\t\t\ticon={ICONS.SETTING_LANGUAGE_ICON}\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tcontent: activeTab === 2 && (\n\t\t\t\t\t<LanguageForm\n\t\t\t\t\t\tonSubmit={(formProps) =>\n\t\t\t\t\t\t\tthis.onSubmitSettings(formProps, 'language')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tformFields={languageFormValue}\n\t\t\t\t\t\tinitialValues={settings}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: isMobile ? (\n\t\t\t\t\t<CustomMobileTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_CHAT}\n\t\t\t\t\t\ticon={ICONS.SETTING_CHAT_ICON}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<CustomTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_CHAT}\n\t\t\t\t\t\ticon={ICONS.SETTING_CHAT_ICON}\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tcontent: activeTab === 3 && (\n\t\t\t\t\t<UsernameForm\n\t\t\t\t\t\tonSubmit={this.onSubmitUsername}\n\t\t\t\t\t\tformFields={usernameFormValues}\n\t\t\t\t\t\tinitialValues={{ username }}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: isMobile ? (\n\t\t\t\t\t<CustomMobileTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_AUDIO_CUE}\n\t\t\t\t\t\ticon={ICONS.SETTING_AUDIO_ICON}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<CustomTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_AUDIO_CUE}\n\t\t\t\t\t\ticon={ICONS.SETTING_AUDIO_ICON}\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tcontent: activeTab === 4 && (\n\t\t\t\t\t<AudioCueForm\n\t\t\t\t\t\tonSubmit={(formProps) =>\n\t\t\t\t\t\t\tthis.onSubmitSettings(formProps, 'audio')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tformFields={audioFormValues}\n\t\t\t\t\t\tinitialValues={settings.audio}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: isMobile ? (\n\t\t\t\t\t<CustomMobileTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_MANAGE_RISK}\n\t\t\t\t\t\ticon={ICONS.SETTING_RISK_ICON}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<CustomTabs\n\t\t\t\t\t\ttitle={STRINGS.USER_SETTINGS.TITLE_MANAGE_RISK}\n\t\t\t\t\t\ticon={ICONS.SETTING_RISK_ICON}\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tcontent: activeTab === 5 && (\n\t\t\t\t\t<RiskForm\n\t\t\t\t\t\tcoins={coins}\n\t\t\t\t\t\tonAdjustPortfolio={this.onAdjustPortfolio}\n\t\t\t\t\t\ttotalAssets={this.state.totalAssets}\n\t\t\t\t\t\tonSubmit={(formProps) =>\n\t\t\t\t\t\t\tthis.onSubmitSettings(formProps, 'risk')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tformFields={warningFormValues}\n\t\t\t\t\t\tinitialValues={settings.risk}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t}\n\t\t];\n\n\t\tthis.setState({ tabs });\n\t};\n\n\trenderContent = (tabs, activeTab) =>\n\t\ttabs[activeTab] && tabs[activeTab].content ? (\n\t\t\ttabs[activeTab].content\n\t\t) : (\n\t\t\t<div />\n\t\t);\n\n\tonSubmitSettings = (formProps, formKey) => {\n\t\tlet settings = {};\n\t\tswitch (formKey) {\n\t\t\tcase 'notification':\n\t\t\t\tsettings.notification = formProps;\n\t\t\t\tbreak;\n\t\t\tcase 'interface':\n\t\t\t\tsettings = { ...formProps }; // ToDo: need to be removed after end point update\n\t\t\t\tsettings.interface = formProps;\n\t\t\t\tbreak;\n\t\t\tcase 'language':\n\t\t\t\tsettings = { ...formProps };\n\t\t\t\tbreak;\n\t\t\tcase 'chat':\n\t\t\t\tsettings.chat = { ...formProps };\n\t\t\t\tbreak;\n\t\t\tcase 'audio':\n\t\t\t\tsettings.audio = formProps;\n\t\t\t\tbreak;\n\t\t\tcase 'risk':\n\t\t\t\tsettings.risk = formProps;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t\treturn updateUser({ settings })\n\t\t\t.then(({ data }) => {\n\t\t\t\tthis.props.setUserData(data);\n\t\t\t\tthis.props.changeLanguage(data.settings.language);\n\t\t\t\tthis.props.changeTheme(data.settings.interface.theme);\n\t\t\t\tthis.props.closeNotification();\n\t\t\t\tlocalStorage.setItem('theme', data.settings.interface.theme);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconst _error =\n\t\t\t\t\terr.response && err.response.data\n\t\t\t\t\t\t? err.response.data.message\n\t\t\t\t\t\t: err.message;\n\t\t\t\tthrow new SubmissionError({ _error });\n\t\t\t});\n\t};\n\n\tonSubmitUsername = (values) => {\n\t\treturn setUsername(values)\n\t\t\t.then(() => {\n\t\t\t\tthis.props.setUsernameStore(values.username);\n\t\t\t\tthis.onSubmitSettings({ set_username: true }, 'chat');\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconst _error =\n\t\t\t\t\terr.response && err.response.data\n\t\t\t\t\t\t? err.response.data.message\n\t\t\t\t\t\t: err.message;\n\t\t\t\tthrow new SubmissionError({ username: _error });\n\t\t\t});\n\t};\n\n\tlogout = (message = '') => {\n\t\tthis.props.logout(typeof message === 'string' ? message : '');\n\t};\n\n\topenContactForm = () => {\n\t\tthis.props.openContactForm();\n\t};\n\n\tsetActiveTab = (activeTab) => {\n\t\tthis.setState({ activeTab });\n\t\tif (this.props.location.query && this.props.location.query.tab) {\n\t\t\tthis.removeQueryString();\n\t\t}\n\t};\n\tremoveQueryString = () => {\n\t\tbrowserHistory.push('/settings');\n\t};\n\n\trender() {\n\t\tif (this.props.verification_level === 0) {\n\t\t\treturn <Loader />;\n\t\t}\n\n\t\tconst { activeTab, tabs } = this.state;\n\t\treturn (\n\t\t\t<div className=\"presentation_container apply_rtl verification_container\">\n\t\t\t\t{!isMobile && (\n\t\t\t\t\t<IconTitle\n\t\t\t\t\t\ttext={STRINGS.ACCOUNTS.TAB_SETTINGS}\n\t\t\t\t\t\ttextType=\"title\"\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<HeaderSection\n\t\t\t\t\ttitle={STRINGS.ACCOUNTS.TAB_SETTINGS}\n\t\t\t\t\topenContactForm={this.openContactForm}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"header-content\">\n\t\t\t\t\t\t<div>{STRINGS.USER_SETTINGS.TITLE_TEXT_1}</div>\n\t\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t\t{STRINGS.USER_SETTINGS.TITLE_TEXT_2}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</HeaderSection>\n\t\t\t\t{!isMobile ? (\n\t\t\t\t\t<CustomTabBar\n\t\t\t\t\t\tactiveTab={activeTab}\n\t\t\t\t\t\tsetActiveTab={this.setActiveTab}\n\t\t\t\t\t\ttabs={tabs}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<MobileTabBar\n\t\t\t\t\t\tactiveTab={activeTab}\n\t\t\t\t\t\trenderContent={this.renderContent}\n\t\t\t\t\t\tsetActiveTab={this.setActiveTab}\n\t\t\t\t\t\ttabs={tabs}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{!isMobile ? this.renderContent(tabs, activeTab) : null}\n\t\t\t\t{isMobile && (\n\t\t\t\t\t<div className=\"my-4\">\n\t\t\t\t\t\t{/* <Button label={STRINGS.ACCOUNTS.TAB_SIGNOUT} onClick={this.logout} /> */}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nconst mapStateToProps = (state) => ({\n\tcoins: state.app.coins,\n\tverification_level: state.user.verification_level,\n\tsettings: state.user.settings,\n\tusername: state.user.username,\n\tactiveLanguage: state.app.language,\n\tbalance: state.user.balance,\n\tprices: state.orderbook.prices,\n\tuser: state.user,\n\tprice: state.orderbook.price,\n\torders: state.order.activeOrders\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n\tsetUsernameStore: bindActionCreators(setUsernameStore, dispatch),\n\tsetUserData: bindActionCreators(setUserData, dispatch),\n\tchangeLanguage: bindActionCreators(setLanguage, dispatch),\n\tchangeTheme: bindActionCreators(changeTheme, dispatch),\n\topenContactForm: bindActionCreators(openContactForm, dispatch),\n\topenRiskPortfolioOrderWarning: bindActionCreators(\n\t\topenRiskPortfolioOrderWarning,\n\t\tdispatch\n\t),\n\tcloseNotification: bindActionCreators(closeNotification, dispatch),\n\tlogout: bindActionCreators(logout, dispatch)\n});\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchToProps\n)(UserSettings);\n"]},"metadata":{},"sourceType":"module"}