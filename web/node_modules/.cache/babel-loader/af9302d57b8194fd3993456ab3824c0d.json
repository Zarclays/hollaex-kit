{"ast":null,"code":"import _classCallCheck from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/user/Documents/projects/hollaex/src/containers/Admin/Audits/index.js\";\nimport React, { Component } from 'react';\nimport { Row, Col, Table, Spin } from 'antd';\nimport { CSVLink } from 'react-csv';\nimport { requestUserAudits } from './actions';\nimport { SubmissionError } from 'redux-form';\nimport Moment from 'react-moment';\nvar INITIAL_STATE = {\n  tradeHistory: '',\n  loading: true\n};\n\nvar formatDate = function formatDate(value) {\n  return React.createElement(Moment, {\n    format: \"YYYY/MM/DD HH:mm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16\n    },\n    __self: this\n  }, value);\n};\n\nvar formatDescription = function formatDescription(value) {\n  if (value.old) {\n    return Object.keys(value.old).map(function (item, key) {\n      return React.createElement(\"div\", {\n        key: item,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 23\n        },\n        __self: this\n      }, item, \": \", JSON.stringify(value.old[item]), \" ->\", ' ', JSON.stringify(value.new[item]));\n    });\n  }\n\n  return null;\n};\n\nvar formatDescriptionNote = function formatDescriptionNote(value) {\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34\n    },\n    __self: this\n  }, value.note);\n};\n\nvar AUDIT_COLUMNS = [{\n  title: 'Event',\n  dataIndex: 'event',\n  key: 'event'\n}, {\n  title: 'Change',\n  dataIndex: 'description',\n  key: 'old',\n  render: formatDescription\n}, {\n  title: 'Note',\n  dataIndex: 'description',\n  key: 'note',\n  render: formatDescriptionNote\n}, {\n  title: 'Admin',\n  dataIndex: 'admin_id',\n  key: 'admin_id'\n}, {\n  title: 'IP',\n  dataIndex: 'ip',\n  key: 'ip'\n}, {\n  title: 'Domain',\n  dataIndex: 'domain',\n  key: 'domain'\n}, {\n  title: 'Time',\n  dataIndex: 'timestamp',\n  key: 'timestamp',\n  render: formatDate\n}];\nvar CSV_AUDIT_COLUMNS = [{\n  label: 'Event',\n  dataIndex: 'event',\n  key: 'event'\n}, {\n  label: 'IP',\n  dataIndex: 'ip',\n  key: 'ip'\n}, {\n  label: 'Domain',\n  dataIndex: 'domain',\n  key: 'domain'\n}, {\n  label: 'Time',\n  dataIndex: 'timestamp',\n  key: 'timestamp'\n}];\n\nvar Audits =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Audits, _Component);\n\n  function Audits() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Audits);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Audits)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = INITIAL_STATE;\n\n    _this.componentWillMount = function () {\n      if (_this.props.userId) {\n        _this.handleUserAudits(_this.props.userId);\n      }\n    };\n\n    _this.handleUserAudits = function (userId) {\n      requestUserAudits(userId).then(function (res) {\n        if (res) {\n          _this.setState({\n            audits: res.data,\n            loading: false\n          });\n        }\n      }).catch(function (err) {\n        if (err.status === 403) {\n          _this.setState({\n            loading: false\n          });\n        }\n\n        throw new SubmissionError({\n          _error: err.data.message\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Audits, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          audits = _this$state.audits,\n          loading = _this$state.loading;\n\n      if (loading) {\n        return React.createElement(\"div\", {\n          className: \"app_container-content\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, React.createElement(Spin, {\n          size: \"large\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101\n          },\n          __self: this\n        }));\n      }\n\n      return React.createElement(Row, {\n        gutter: 16,\n        style: {\n          marginTop: 16\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(CSVLink, {\n        filename: 'audits-history.csv',\n        data: audits ? audits : 'No Data',\n        headers: CSV_AUDIT_COLUMNS,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Download table\"), React.createElement(Table, {\n        rowKey: function rowKey(data) {\n          return data.id;\n        },\n        columns: AUDIT_COLUMNS,\n        dataSource: audits ? audits : 'No Data',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Audits;\n}(Component);\n\nexport default Audits;","map":{"version":3,"sources":["/home/user/Documents/projects/hollaex/src/containers/Admin/Audits/index.js"],"names":["React","Component","Row","Col","Table","Spin","CSVLink","requestUserAudits","SubmissionError","Moment","INITIAL_STATE","tradeHistory","loading","formatDate","value","formatDescription","old","Object","keys","map","item","key","JSON","stringify","new","formatDescriptionNote","note","AUDIT_COLUMNS","title","dataIndex","render","CSV_AUDIT_COLUMNS","label","Audits","state","componentWillMount","props","userId","handleUserAudits","then","res","setState","audits","data","catch","err","status","_error","message","marginTop","id"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Row, Col, Table, Spin } from 'antd';\nimport { CSVLink } from 'react-csv';\nimport { requestUserAudits } from './actions';\n\nimport { SubmissionError } from 'redux-form';\n\nimport Moment from 'react-moment';\n\nconst INITIAL_STATE = {\n\ttradeHistory: '',\n\tloading: true\n};\n\nconst formatDate = (value) => {\n\treturn <Moment format=\"YYYY/MM/DD HH:mm\">{value}</Moment>;\n};\n\nconst formatDescription = (value) => {\n\tif (value.old) {\n\t\treturn Object.keys(value.old).map((item, key) => {\n\t\t\treturn (\n\t\t\t\t<div key={item}>\n\t\t\t\t\t{item}: {JSON.stringify(value.old[item])} ->{' '}\n\t\t\t\t\t{JSON.stringify(value.new[item])}\n\t\t\t\t</div>\n\t\t\t);\n\t\t});\n\t}\n\treturn null;\n};\n\nconst formatDescriptionNote = (value) => {\n\treturn <div>{value.note}</div>;\n};\n\nconst AUDIT_COLUMNS = [\n\t{ title: 'Event', dataIndex: 'event', key: 'event' },\n\t{\n\t\ttitle: 'Change',\n\t\tdataIndex: 'description',\n\t\tkey: 'old',\n\t\trender: formatDescription\n\t},\n\t{\n\t\ttitle: 'Note',\n\t\tdataIndex: 'description',\n\t\tkey: 'note',\n\t\trender: formatDescriptionNote\n\t},\n\t{ title: 'Admin', dataIndex: 'admin_id', key: 'admin_id' },\n\t{ title: 'IP', dataIndex: 'ip', key: 'ip' },\n\t{ title: 'Domain', dataIndex: 'domain', key: 'domain' },\n\t{\n\t\ttitle: 'Time',\n\t\tdataIndex: 'timestamp',\n\t\tkey: 'timestamp',\n\t\trender: formatDate\n\t}\n];\nconst CSV_AUDIT_COLUMNS = [\n\t{ label: 'Event', dataIndex: 'event', key: 'event' },\n\t{ label: 'IP', dataIndex: 'ip', key: 'ip' },\n\t{ label: 'Domain', dataIndex: 'domain', key: 'domain' },\n\t{ label: 'Time', dataIndex: 'timestamp', key: 'timestamp' }\n];\n\nclass Audits extends Component {\n\tstate = INITIAL_STATE;\n\n\tcomponentWillMount = () => {\n\t\tif (this.props.userId) {\n\t\t\tthis.handleUserAudits(this.props.userId);\n\t\t}\n\t};\n\n\thandleUserAudits = (userId) => {\n\t\trequestUserAudits(userId)\n\t\t\t.then((res) => {\n\t\t\t\tif (res) {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\taudits: res.data,\n\t\t\t\t\t\tloading: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tif (err.status === 403) {\n\t\t\t\t\tthis.setState({ loading: false });\n\t\t\t\t}\n\t\t\t\tthrow new SubmissionError({ _error: err.data.message });\n\t\t\t});\n\t};\n\n\trender() {\n\t\tconst { audits, loading } = this.state;\n\n\t\tif (loading) {\n\t\t\treturn (\n\t\t\t\t<div className=\"app_container-content\">\n\t\t\t\t\t<Spin size=\"large\" />\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<Row gutter={16} style={{ marginTop: 16 }}>\n\t\t\t\t<Col>\n\t\t\t\t\t<CSVLink\n\t\t\t\t\t\tfilename={'audits-history.csv'}\n\t\t\t\t\t\tdata={audits ? audits : 'No Data'}\n\t\t\t\t\t\theaders={CSV_AUDIT_COLUMNS}\n\t\t\t\t\t>\n\t\t\t\t\t\tDownload table\n\t\t\t\t\t</CSVLink>\n\t\t\t\t\t<Table\n\t\t\t\t\t\trowKey={(data) => {\n\t\t\t\t\t\t\treturn data.id;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tcolumns={AUDIT_COLUMNS}\n\t\t\t\t\t\tdataSource={audits ? audits : 'No Data'}\n\t\t\t\t\t/>\n\t\t\t\t</Col>\n\t\t\t</Row>\n\t\t);\n\t}\n}\n\nexport default Audits;\n"]},"metadata":{},"sourceType":"module"}