{"ast":null,"code":"import _classCallCheck from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _slicedToArray from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/user/Documents/projects/hollaex/src/containers/Trade/components/Orderbook.js\";\nimport React, { Component } from 'react';\nimport classnames from 'classnames';\nimport EventListener from 'react-event-listener';\nimport { connect } from 'react-redux';\nimport { subtract } from '../utils';\nimport { formatCurrency, formatBaseAmount, formatBtcFullAmount, checkNonBasePair } from '../../../utils/currency';\nimport STRINGS from '../../../config/localizedStrings';\nimport { DEFAULT_COIN_DATA } from '../../../config/constants';\n\nvar PriceRow = function PriceRow(pairBase, pairTwo, side, onPriceClick, onAmountClick) {\n  return function (_ref, index) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        price = _ref2[0],\n        amount = _ref2[1];\n\n    return React.createElement(\"div\", {\n      key: \"\".concat(side, \"-\").concat(price),\n      className: \"d-flex value-row align-items-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 15\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"f-1 trade_orderbook-cell trade_orderbook-cell-price \".concat(side, \" pointer\"),\n      onClick: onPriceClick(price),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 16\n      },\n      __self: this\n    }, formatCurrency(price, pairTwo, true)), React.createElement(\"div\", {\n      className: \"f-1 trade_orderbook-cell trade_orderbook-cell-amount pointer\",\n      onClick: onAmountClick(amount),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 22\n      },\n      __self: this\n    }, formatCurrency(amount, pairBase, true)));\n  };\n};\n\nvar calculateSpread = function calculateSpread(asks, bids, pair, coins) {\n  var lowerAsk = asks.length > 0 ? asks[0][0] : 0;\n  var higherBid = bids.length > 0 ? bids[0][0] : 0;\n  var isNonBasePair = checkNonBasePair(pair, coins);\n\n  if (lowerAsk && higherBid) {\n    return isNonBasePair ? formatBtcFullAmount(subtract(lowerAsk, higherBid)) : formatBaseAmount(subtract(lowerAsk, higherBid));\n  }\n\n  return '-';\n};\n\nvar LimitBar = function LimitBar(_ref3) {\n  var text = _ref3.text;\n  return React.createElement(\"div\", {\n    className: \"d-flex align-items-center orderbook-limit_bar-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"f-1 orderbook-limit_bar-line\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }), React.createElement(\"span\", {\n    className: \"orderbook-limit_bar-text font-weight-bold\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, text));\n};\n\nvar Orderbook =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Orderbook, _Component);\n\n  function Orderbook() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Orderbook);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Orderbook)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      dataBlockHeight: 0\n    };\n\n    _this.setRefs = function (key) {\n      return function (el) {\n        _this[key] = el;\n      };\n    };\n\n    _this.scrollTop = function () {\n      if (_this.wrapper && _this.spreadWrapper) {\n        var maxContentHeight = _this.wrapper.offsetHeight - _this.spreadWrapper.offsetHeight;\n        var accumulatedHeight = _this.bidsWrapper.scrollHeight + _this.asksWrapper.scrollHeight;\n        var dataBlockHeight = maxContentHeight / 2;\n        var needScroll = accumulatedHeight > maxContentHeight;\n        var askDif = _this.asksWrapper.scrollHeight - dataBlockHeight;\n\n        if (needScroll && askDif > 0) {\n          _this.wrapper.scrollTop = askDif;\n        }\n\n        _this.setState({\n          dataBlockHeight: dataBlockHeight\n        });\n      }\n    };\n\n    _this.onPriceClick = function (price) {\n      return function () {\n        _this.props.onPriceClick(price);\n      };\n    };\n\n    _this.onAmountClick = function (price) {\n      return function () {\n        _this.props.onAmountClick(price);\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(Orderbook, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.scrollTop();\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {// this.scrollTop();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          asks = _this$props.asks,\n          bids = _this$props.bids,\n          pairData = _this$props.pairData,\n          pair = _this$props.pair,\n          coins = _this$props.coins; // const blockStyle = {};\n\n      var dataBlockHeight = this.state.dataBlockHeight;\n      var blockStyle = dataBlockHeight > 0 ? {\n        // maxHeight: dataBlockHeight,\n        minHeight: dataBlockHeight\n      } : {};\n      var pairBase = pairData.pair_base.toUpperCase();\n      var pairTwo = pairData.pair_2.toUpperCase();\n\n      var _ref4 = coins[pairTwo] || DEFAULT_COIN_DATA,\n          symbol = _ref4.symbol;\n\n      return React.createElement(\"div\", {\n        className: \"trade_orderbook-wrapper d-flex flex-column f-1 apply_rtl\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, React.createElement(EventListener, {\n        target: \"window\",\n        onResize: this.scrollTop,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"trade_orderbook-headers d-flex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"f-1 trade_orderbook-cell\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, STRINGS.formatString(STRINGS.PRICE_CURRENCY, symbol.toUpperCase())), React.createElement(\"div\", {\n        className: \"f-1 trade_orderbook-cell\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, STRINGS.formatString(STRINGS.AMOUNT_SYMBOL, pairBase))), React.createElement(\"div\", {\n        className: \"trade_asks-limit_bar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(LimitBar, {\n        text: STRINGS.ORDERBOOK_SELLERS,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        ref: this.setRefs('wrapper'),\n        className: classnames('trade_orderbook-content', 'f-1', 'overflow-y'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: classnames('trade_orderbook-asks', 'd-flex', 'flex-column-reverse'),\n        style: blockStyle,\n        ref: this.setRefs('asksWrapper'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, asks.map(PriceRow(pairBase, pairTwo, 'ask', this.onPriceClick, this.onAmountClick))), React.createElement(\"div\", {\n        className: \"trade_orderbook-spread d-flex align-items-center\",\n        ref: this.setRefs('spreadWrapper'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, STRINGS.formatString(STRINGS.ORDERBOOK_SPREAD, React.createElement(\"div\", {\n        className: \"trade_orderbook-spread-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, STRINGS.formatString(STRINGS.ORDERBOOK_SPREAD_PRICE, calculateSpread(asks, bids, pair, coins), symbol.toUpperCase())))), React.createElement(\"div\", {\n        className: classnames('trade_orderbook-bids', 'd-flex', 'flex-column'),\n        ref: this.setRefs('bidsWrapper'),\n        style: blockStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, bids.map(PriceRow(pairBase, pairTwo, 'bids', this.onPriceClick, this.onAmountClick)))), React.createElement(\"div\", {\n        className: \"trade_bids-limit_bar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(LimitBar, {\n        text: STRINGS.ORDERBOOK_BUYERS,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Orderbook;\n}(Component);\n\nOrderbook.defaultProps = {\n  asks: [],\n  bids: [],\n  ready: false,\n  onPriceClick: function onPriceClick() {},\n  onAmountClick: function onAmountClick() {}\n};\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    pair: store.app.pair\n  };\n};\n\nexport default connect(mapStateToProps)(Orderbook);","map":{"version":3,"sources":["/home/user/Documents/projects/hollaex/src/containers/Trade/components/Orderbook.js"],"names":["React","Component","classnames","EventListener","connect","subtract","formatCurrency","formatBaseAmount","formatBtcFullAmount","checkNonBasePair","STRINGS","DEFAULT_COIN_DATA","PriceRow","pairBase","pairTwo","side","onPriceClick","onAmountClick","index","price","amount","calculateSpread","asks","bids","pair","coins","lowerAsk","length","higherBid","isNonBasePair","LimitBar","text","Orderbook","state","dataBlockHeight","setRefs","key","el","scrollTop","wrapper","spreadWrapper","maxContentHeight","offsetHeight","accumulatedHeight","bidsWrapper","scrollHeight","asksWrapper","needScroll","askDif","setState","props","nextProps","pairData","blockStyle","minHeight","pair_base","toUpperCase","pair_2","symbol","formatString","PRICE_CURRENCY","AMOUNT_SYMBOL","ORDERBOOK_SELLERS","map","ORDERBOOK_SPREAD","ORDERBOOK_SPREAD_PRICE","ORDERBOOK_BUYERS","defaultProps","ready","mapStateToProps","store","app"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport classnames from 'classnames';\nimport EventListener from 'react-event-listener';\nimport { connect } from 'react-redux';\n\nimport { subtract } from '../utils';\nimport { formatCurrency, formatBaseAmount, formatBtcFullAmount, checkNonBasePair } from '../../../utils/currency';\nimport STRINGS from '../../../config/localizedStrings';\nimport { DEFAULT_COIN_DATA } from '../../../config/constants';\n\nconst PriceRow = (pairBase, pairTwo, side, onPriceClick, onAmountClick) => (\n\t[price, amount],\n\tindex\n) => (\n\t<div key={`${side}-${price}`} className=\"d-flex value-row align-items-center\">\n\t\t<div\n\t\t\tclassName={`f-1 trade_orderbook-cell trade_orderbook-cell-price ${side} pointer`}\n\t\t\tonClick={onPriceClick(price)}\n\t\t>\n\t\t\t{formatCurrency(price, pairTwo, true)}\n\t\t</div>\n\t\t<div\n\t\t\tclassName=\"f-1 trade_orderbook-cell trade_orderbook-cell-amount pointer\"\n\t\t\tonClick={onAmountClick(amount)}\n\t\t>\n\t\t\t{formatCurrency(amount, pairBase, true)}\n\t\t</div>\n\t</div>\n);\n\nconst calculateSpread = (asks, bids, pair, coins) => {\n\tconst lowerAsk = asks.length > 0 ? asks[0][0] : 0;\n\tconst higherBid = bids.length > 0 ? bids[0][0] : 0;\n\tconst isNonBasePair = checkNonBasePair(pair, coins);\n\tif (lowerAsk && higherBid) {\n\t\treturn isNonBasePair ? formatBtcFullAmount(subtract(lowerAsk, higherBid)) : formatBaseAmount(subtract(lowerAsk, higherBid));\n\t}\n\treturn '-';\n};\n\nconst LimitBar = ({ text }) => (\n\t<div className=\"d-flex align-items-center orderbook-limit_bar-wrapper\">\n\t\t<div className=\"f-1 orderbook-limit_bar-line\" />\n\t\t<span className=\"orderbook-limit_bar-text font-weight-bold\">{text}</span>\n\t</div>\n);\n\nclass Orderbook extends Component {\n\tstate = {\n\t\tdataBlockHeight: 0\n\t};\n\n\tcomponentDidMount() {\n\t\tthis.scrollTop();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\t// this.scrollTop();\n\t}\n\n\tsetRefs = (key) => (el) => {\n\t\tthis[key] = el;\n\t};\n\n\tscrollTop = () => {\n\t\tif (this.wrapper && this.spreadWrapper) {\n\t\t\tconst maxContentHeight =\n\t\t\t\tthis.wrapper.offsetHeight - this.spreadWrapper.offsetHeight;\n\t\t\tconst accumulatedHeight =\n\t\t\t\tthis.bidsWrapper.scrollHeight + this.asksWrapper.scrollHeight;\n\t\t\tconst dataBlockHeight = maxContentHeight / 2;\n\t\t\tconst needScroll = accumulatedHeight > maxContentHeight;\n\t\t\tconst askDif = this.asksWrapper.scrollHeight - dataBlockHeight;\n\n\t\t\tif (needScroll && askDif > 0) {\n\t\t\t\tthis.wrapper.scrollTop = askDif;\n\t\t\t}\n\t\t\tthis.setState({ dataBlockHeight });\n\t\t}\n\t};\n\n\tonPriceClick = (price) => () => {\n\t\tthis.props.onPriceClick(price);\n\t};\n\n\tonAmountClick = (price) => () => {\n\t\tthis.props.onAmountClick(price);\n\t};\n\n\trender() {\n\t\tconst { asks, bids, pairData, pair, coins } = this.props;\n\t\t// const blockStyle = {};\n\t\tconst { dataBlockHeight } = this.state;\n\t\tconst blockStyle =\n\t\t\tdataBlockHeight > 0\n\t\t\t\t? {\n\t\t\t\t\t\t// maxHeight: dataBlockHeight,\n\t\t\t\t\t\tminHeight: dataBlockHeight\n\t\t\t\t\t}\n\t\t\t\t: {};\n\n\t\tconst pairBase = pairData.pair_base.toUpperCase();\n\t\tconst pairTwo = pairData.pair_2.toUpperCase();\n\t\tconst { symbol } = coins[pairTwo] || DEFAULT_COIN_DATA;\n\t\treturn (\n\t\t\t<div className=\"trade_orderbook-wrapper d-flex flex-column f-1 apply_rtl\">\n\t\t\t\t<EventListener target=\"window\" onResize={this.scrollTop} />\n\t\t\t\t<div className=\"trade_orderbook-headers d-flex\">\n\t\t\t\t\t<div className=\"f-1 trade_orderbook-cell\">\n\t\t\t\t\t\t{STRINGS.formatString(\n\t\t\t\t\t\t\tSTRINGS.PRICE_CURRENCY,\n\t\t\t\t\t\t\tsymbol.toUpperCase()\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"f-1 trade_orderbook-cell\">\n\t\t\t\t\t\t{STRINGS.formatString(STRINGS.AMOUNT_SYMBOL, pairBase)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"trade_asks-limit_bar\">\n\t\t\t\t\t<LimitBar text={STRINGS.ORDERBOOK_SELLERS} />\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tref={this.setRefs('wrapper')}\n\t\t\t\t\tclassName={classnames('trade_orderbook-content', 'f-1', 'overflow-y')}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={classnames(\n\t\t\t\t\t\t\t'trade_orderbook-asks',\n\t\t\t\t\t\t\t'd-flex',\n\t\t\t\t\t\t\t'flex-column-reverse'\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tstyle={blockStyle}\n\t\t\t\t\t\tref={this.setRefs('asksWrapper')}\n\t\t\t\t\t>\n\t\t\t\t\t\t{asks.map(PriceRow(pairBase, pairTwo, 'ask', this.onPriceClick, this.onAmountClick))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"trade_orderbook-spread d-flex align-items-center\"\n\t\t\t\t\t\tref={this.setRefs('spreadWrapper')}\n\t\t\t\t\t>\n\t\t\t\t\t\t{STRINGS.formatString(\n\t\t\t\t\t\t\tSTRINGS.ORDERBOOK_SPREAD,\n\t\t\t\t\t\t\t<div className=\"trade_orderbook-spread-text\">\n\t\t\t\t\t\t\t\t{STRINGS.formatString(\n\t\t\t\t\t\t\t\t\tSTRINGS.ORDERBOOK_SPREAD_PRICE,\n\t\t\t\t\t\t\t\t\tcalculateSpread(asks, bids, pair, coins),\n\t\t\t\t\t\t\t\t\tsymbol.toUpperCase()\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={classnames(\n\t\t\t\t\t\t\t'trade_orderbook-bids',\n\t\t\t\t\t\t\t'd-flex',\n\t\t\t\t\t\t\t'flex-column'\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tref={this.setRefs('bidsWrapper')}\n\t\t\t\t\t\tstyle={blockStyle}\n\t\t\t\t\t>\n\t\t\t\t\t\t{bids.map(PriceRow(pairBase, pairTwo, 'bids', this.onPriceClick, this.onAmountClick))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"trade_bids-limit_bar\">\n\t\t\t\t\t<LimitBar text={STRINGS.ORDERBOOK_BUYERS} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nOrderbook.defaultProps = {\n\tasks: [],\n\tbids: [],\n\tready: false,\n\tonPriceClick: () => {},\n\tonAmountClick: () => {}\n};\n\nconst mapStateToProps = (store) => ({\n\tpair: store.app.pair\n});\n\nexport default connect(mapStateToProps)(Orderbook);\n"]},"metadata":{},"sourceType":"module"}