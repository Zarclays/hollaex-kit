{"ast":null,"code":"import _slicedToArray from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/user/Documents/projects/hollaex/src/components/AppBar/PairTabs.js\";\nimport React, { Component } from 'react';\nimport ReactSVG from 'react-svg';\nimport { connect } from 'react-redux';\nimport classnames from 'classnames';\nimport Tab from './Tab';\nimport AddTabList from './AddTabList';\nimport TabOverflowList from './TabOverflowList';\nimport { DEFAULT_TRADING_PAIRS, DEFAULT_COIN_DATA } from '../../config/constants';\nimport { ICONS } from '../../config/constants';\nimport STRINGS from '../../config/localizedStrings';\nvar timeOut = '';\n\nvar PairTabs =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PairTabs, _Component);\n\n  function PairTabs() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, PairTabs);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PairTabs)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      selectedTabs: {},\n      activeTabs: {},\n      activePairTab: '',\n      isAddTab: false,\n      selectedAddTab: '',\n      isTabOverflow: false,\n      searchValue: '',\n      searchResult: {},\n      selectedToRemove: '',\n      selectedToOpen: ''\n    };\n\n    _this.initTabs = function (pairs, activePair) {\n      var tabs = localStorage.getItem('tabs');\n\n      if (tabs === null || tabs === '') {\n        tabs = DEFAULT_TRADING_PAIRS;\n      } else if (tabs) {\n        tabs = JSON.parse(tabs);\n      } else {\n        tabs = [];\n      }\n\n      if (Object.keys(pairs).length) {\n        var tempTabs = {};\n        var selected = {};\n\n        if (activePair && !Object.keys(pairs).filter(function (value) {\n          return value === activePair;\n        }).length) {\n          _this.props.router.push('/trade/add/tabs');\n        }\n\n        tabs.map(function (key, index) {\n          if (pairs[key]) {\n            if (index <= 3) tempTabs[key] = pairs[key];\n            selected[key] = pairs[key];\n          }\n\n          return key;\n        });\n\n        if (activePair && !tempTabs[activePair] && tabs.length) {\n          var temp = pairs[activePair];\n          var pairKeys = Object.keys(tempTabs);\n\n          if (pairKeys.length < 4) {\n            tempTabs[activePair] = temp;\n          } else {\n            delete tempTabs[pairKeys[pairKeys.length - 1]];\n            tempTabs[activePair] = temp;\n          }\n\n          if (!selected[activePair]) {\n            selected[activePair] = temp;\n          }\n        }\n\n        _this.setState({\n          selectedTabs: selected,\n          activeTabs: tempTabs\n        });\n\n        _this.setTabsLocal(selected);\n      }\n    };\n\n    _this.onTabClick = function (pair) {\n      if (pair) {\n        _this.props.router.push(\"/trade/\".concat(pair));\n\n        _this.setState({\n          activePairTab: pair\n        });\n      }\n    };\n\n    _this.openAddTabMenu = function (e) {\n      _this.setState({\n        isAddTab: !_this.state.isAddTab,\n        isTabOverflow: false\n      });\n    };\n\n    _this.onAddTabClick = function (pair) {\n      _this.setState({\n        selectedAddTab: pair\n      });\n    };\n\n    _this.onTabChange = function (pair) {\n      var _this$state = _this.state,\n          selectedTabs = _this$state.selectedTabs,\n          activeTabs = _this$state.activeTabs,\n          activePairTab = _this$state.activePairTab,\n          selectedToOpen = _this$state.selectedToOpen;\n      var _this$props = _this.props,\n          activePath = _this$props.activePath,\n          pairs = _this$props.pairs;\n      var localTabs = {};\n      var tabPairs = [];\n\n      if (selectedTabs[pair]) {\n        localTabs = _objectSpread({}, selectedTabs);\n        tabPairs = Object.keys(localTabs);\n        delete localTabs[pair];\n\n        _this.setTabsLocal(localTabs);\n\n        if (activePairTab === pair || activePath !== 'trade') {\n          var index = tabPairs.indexOf(pair);\n          var tabValue = '';\n\n          if (index < tabPairs.length - 1) {\n            tabValue = tabPairs[index + 1];\n          } else {\n            tabValue = tabPairs[index - 1];\n          }\n\n          timeOut = setTimeout(function () {\n            _this.onTabClick(tabValue);\n          }, 300);\n        }\n\n        tabPairs = Object.keys(localTabs);\n\n        _this.setState({\n          selectedTabs: _objectSpread({}, localTabs),\n          selectedToRemove: pair,\n          selectedToOpen: ''\n        });\n      } else {\n        var temp = pairs[pair];\n\n        if (temp && temp.pair_base) {\n          localTabs = _objectSpread({}, selectedTabs, _defineProperty({}, pair, temp));\n          tabPairs = Object.keys(localTabs);\n\n          _this.setState({\n            selectedTabs: _objectSpread({}, localTabs),\n            selectedToOpen: pair,\n            selectedToRemove: ''\n          });\n        }\n\n        _this.setTabsLocal(localTabs);\n\n        _this.onTabClick(pair);\n      }\n\n      if (activeTabs[pair]) {\n        var tempActive = {};\n        tabPairs.map(function (key, index) {\n          if (index <= 3) {\n            tempActive = _objectSpread({}, tempActive, _defineProperty({}, key, localTabs[key]));\n          }\n\n          return key;\n        });\n        timeOut = setTimeout(function () {\n          _this.setState({\n            activeTabs: _objectSpread({}, tempActive)\n          });\n        }, 300);\n      } else if (!activeTabs[pair] && localTabs[pair]) {\n        var _tempActive = activeTabs;\n        var activeKeys = Object.keys(activeTabs);\n        timeOut = setTimeout(function () {\n          if (tabPairs.length <= 4) {\n            _this.setState({\n              activeTabs: _objectSpread({}, localTabs)\n            });\n          } else {\n            delete _tempActive[activeKeys[activeKeys.length - 1]];\n            _tempActive[pair] = localTabs[pair];\n\n            _this.setState({\n              activeTabs: _objectSpread({}, _tempActive)\n            });\n          }\n        }, 300);\n      }\n\n      if (!tabPairs.length) {\n        _this.setNoTabs();\n      }\n\n      if (activeTabs[pair] && pair !== activePairTab && selectedToOpen === activePairTab) {\n        _this.setState({\n          selectedToOpen: ''\n        });\n      } // this.setTabsLocal(localTabs);\n\n\n      _this.closeAddTabMenu();\n    };\n\n    _this.onOverflowClick = function () {\n      _this.setState({\n        isTabOverflow: !_this.state.isTabOverflow,\n        isAddTab: false\n      });\n    };\n\n    _this.handleOverflow = function (pair) {\n      var _this$state2 = _this.state,\n          selectedTabs = _this$state2.selectedTabs,\n          activeTabs = _this$state2.activeTabs;\n\n      if (!activeTabs[pair]) {\n        var tempTabs = _objectSpread(_defineProperty({}, pair, selectedTabs[pair]), activeTabs);\n\n        var pairs = Object.keys(tempTabs);\n        delete tempTabs[pairs[pairs.length - 1]];\n\n        _this.setState({\n          activeTabs: _objectSpread({}, tempTabs),\n          selectedTabs: _objectSpread({}, tempTabs, _this.state.selectedTabs)\n        });\n\n        _this.setTabsLocal(_objectSpread({}, tempTabs, _this.state.selectedTabs));\n      }\n\n      _this.onTabClick(pair);\n\n      _this.closeOverflowMenu();\n    };\n\n    _this.closeAddTabMenu = function () {\n      _this.setState({\n        isAddTab: false,\n        searchValue: '',\n        searchResult: {}\n      });\n    };\n\n    _this.closeOverflowMenu = function () {\n      _this.setState({\n        isTabOverflow: false\n      });\n    };\n\n    _this.onSortItems = function (sortItems) {\n      var sortedTabs = {};\n      sortItems.map(function (pair) {\n        var temp = _this.state.activeTabs[pair];\n        sortedTabs[pair] = temp;\n        return pair;\n      });\n\n      _this.setTabsLocal(_objectSpread({}, sortedTabs, _this.state.selectedTabs));\n\n      _this.setState({\n        activeTabs: _objectSpread({}, sortedTabs),\n        selectedTabs: _objectSpread({}, sortedTabs, _this.state.selectedTabs)\n      });\n    };\n\n    _this.handleSearch = function (_, value) {\n      var _this$props2 = _this.props,\n          pairs = _this$props2.pairs,\n          coins = _this$props2.coins;\n\n      if (value) {\n        var result = {};\n        var searchValue = value.toLowerCase().trim();\n        Object.keys(pairs).map(function (key) {\n          var temp = pairs[key];\n\n          var _ref = coins[temp.pair_base.toLowerCase()] || DEFAULT_COIN_DATA,\n              fullname = _ref.fullname;\n\n          var cashName = fullname ? fullname.toLowerCase() : '';\n\n          if (key.indexOf(searchValue) !== -1 || temp.pair_base.indexOf(searchValue) !== -1 || temp.pair_2.indexOf(searchValue) !== -1 || cashName.indexOf(searchValue) !== -1) {\n            result[key] = temp;\n          }\n\n          return key;\n        });\n\n        _this.setState({\n          searchResult: _objectSpread({}, result),\n          searchValue: value\n        });\n      } else {\n        _this.setState({\n          searchResult: {},\n          searchValue: ''\n        });\n      }\n    };\n\n    _this.setTabsLocal = function (tabs) {\n      localStorage.setItem('tabs', JSON.stringify(Object.keys(tabs)));\n    };\n\n    _this.setNoTabs = function () {\n      _this.props.router.push('/account');\n    };\n\n    return _this;\n  }\n\n  _createClass(PairTabs, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props3 = this.props,\n          router = _this$props3.router,\n          pairs = _this$props3.pairs,\n          location = _this$props3.location;\n      var active = '';\n\n      if (router && router.params.pair) {\n        var tabs = localStorage.getItem('tabs');\n\n        if (tabs !== null && tabs !== '' && !JSON.parse(tabs).length && location.pathname.indexOf('/trade/') === 0) {\n          this.setNoTabs();\n        }\n\n        active = router.params.pair;\n        this.setState({\n          activePairTab: router.params.pair,\n          selectedToOpen: router.params.pair\n        });\n      } else {\n        active = '';\n        this.setState({\n          activePairTab: ''\n        });\n      }\n\n      this.initTabs(pairs, active);\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var activePath = nextProps.activePath,\n          pairs = nextProps.pairs,\n          router = nextProps.router,\n          location = nextProps.location;\n      var active = this.state.activePairTab;\n      var selectedToOpen = '';\n\n      if (this.props.activePath !== activePath) {\n        if (activePath !== 'trade') {\n          active = \"\";\n          this.setState({\n            activePairTab: '',\n            selectedToOpen: ''\n          });\n        }\n      }\n\n      if (JSON.stringify(this.props.pairs) !== JSON.stringify(pairs)) {\n        this.initTabs(pairs, active);\n      }\n\n      if (this.props.location && location && this.props.location.pathname !== location.pathname) {\n        if (router && router.params.pair && location.pathname.indexOf('/trade/') === 0) {\n          active = router.params.pair;\n\n          if (!this.state.activeTabs[active]) {\n            selectedToOpen = active;\n          }\n\n          this.setState({\n            activePairTab: router.params.pair,\n            selectedToOpen: selectedToOpen\n          });\n          var tabs = localStorage.getItem('tabs');\n\n          if (tabs !== null && tabs !== '' && !JSON.parse(tabs).length) {\n            this.setNoTabs();\n          }\n        } else if (router && !router.params.pair) {\n          active = \"\";\n          this.setState({\n            activePairTab: '',\n            selectedToOpen: ''\n          });\n        }\n\n        this.initTabs(pairs, active);\n      }\n\n      if (this.props.activeLanguage !== nextProps.activeLanguage) {\n        this.initTabs(pairs, active);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (timeOut) {\n        clearTimeout(timeOut);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state3 = this.state,\n          selectedTabs = _this$state3.selectedTabs,\n          isAddTab = _this$state3.isAddTab,\n          selectedAddTab = _this$state3.selectedAddTab,\n          activePairTab = _this$state3.activePairTab,\n          isTabOverflow = _this$state3.isTabOverflow,\n          activeTabs = _this$state3.activeTabs,\n          searchValue = _this$state3.searchValue,\n          searchResult = _this$state3.searchResult,\n          selectedToOpen = _this$state3.selectedToOpen,\n          selectedToRemove = _this$state3.selectedToRemove;\n      var _this$props4 = this.props,\n          pairs = _this$props4.pairs,\n          tickers = _this$props4.tickers,\n          location = _this$props4.location,\n          coins = _this$props4.coins;\n      var obj = {};\n      Object.entries(pairs).forEach(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n            key = _ref3[0],\n            pair = _ref3[1];\n\n        obj[pair.pair_base] = '';\n      });\n      var symbols = Object.keys(obj).map(function (key) {\n        return key;\n      });\n      var TabList = Object.keys(activeTabs).map(function (tab, index) {\n        var pair = activeTabs[tab];\n        var ticker = tickers[tab];\n\n        if (index <= 3) {\n          return React.createElement(Tab, {\n            key: index,\n            tab: tab,\n            pair: pair,\n            ticker: ticker,\n            coins: coins,\n            selectedToOpen: selectedToOpen,\n            selectedToRemove: selectedToRemove,\n            activePairTab: activePairTab,\n            onSortItems: _this2.onSortItems,\n            items: Object.keys(activeTabs),\n            sortId: index,\n            onTabClick: _this2.onTabClick,\n            onTabChange: _this2.onTabChange,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 301\n            },\n            __self: this\n          });\n        }\n\n        return null;\n      });\n      return React.createElement(\"div\", {\n        className: \"d-flex h-100\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }, TabList, React.createElement(\"div\", {\n        className: classnames('app_bar-pair-content', 'd-flex', 'justify-content-between', 'px-2', {\n          'active-tab-pair': isAddTab || location.pathname === '/trade/add/tabs' && !Object.keys(selectedTabs).length\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 322\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        onClick: this.openAddTabMenu,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }, React.createElement(ReactSVG, {\n        path: ICONS.TAB_PLUS,\n        wrapperClassName: \"app-bar-tab-close\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333\n        },\n        __self: this\n      })), Object.keys(selectedTabs).length <= 0 ? React.createElement(\"span\", {\n        onClick: this.openAddTabMenu,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336\n        },\n        __self: this\n      }, STRINGS.ADD_TRADING_PAIR) : '', isAddTab && React.createElement(AddTabList, {\n        symbols: symbols,\n        pairs: pairs,\n        tickers: tickers,\n        coins: coins,\n        selectedTabs: selectedTabs,\n        activeTabs: activeTabs,\n        selectedTabMenu: selectedAddTab || symbols[0],\n        searchValue: searchValue,\n        searchResult: searchResult,\n        onAddTabClick: this.onAddTabClick,\n        onTabChange: this.onTabChange,\n        closeAddTabMenu: this.closeAddTabMenu,\n        handleSearch: this.handleSearch,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339\n        },\n        __self: this\n      })), Object.keys(selectedTabs).length > 4 && React.createElement(\"div\", {\n        className: classnames('app_bar-pair-overflow', 'd-flex', 'align-items-center', {\n          'active-tab-overflow': isTabOverflow\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 357\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        onClick: this.onOverflowClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359\n        },\n        __self: this\n      }, React.createElement(ReactSVG, {\n        path: ICONS.DOUBLE_ARROW,\n        wrapperClassName: \"app-bar-tab-close\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360\n        },\n        __self: this\n      })), isTabOverflow && React.createElement(TabOverflowList, {\n        activeTabs: activeTabs,\n        activePairTab: activePairTab,\n        selectedTabs: selectedTabs,\n        tickers: tickers,\n        coins: coins,\n        handleOverflow: this.handleOverflow,\n        closeOverflowMenu: this.closeOverflowMenu,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return PairTabs;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    activeLanguage: store.app.language,\n    pairs: store.app.pairs,\n    tickers: store.app.tickers,\n    coins: store.app.coins\n  };\n};\n\nexport default connect(mapStateToProps)(PairTabs);","map":{"version":3,"sources":["/home/user/Documents/projects/hollaex/src/components/AppBar/PairTabs.js"],"names":["React","Component","ReactSVG","connect","classnames","Tab","AddTabList","TabOverflowList","DEFAULT_TRADING_PAIRS","DEFAULT_COIN_DATA","ICONS","STRINGS","timeOut","PairTabs","state","selectedTabs","activeTabs","activePairTab","isAddTab","selectedAddTab","isTabOverflow","searchValue","searchResult","selectedToRemove","selectedToOpen","initTabs","pairs","activePair","tabs","localStorage","getItem","JSON","parse","Object","keys","length","tempTabs","selected","filter","value","props","router","push","map","key","index","temp","pairKeys","setState","setTabsLocal","onTabClick","pair","openAddTabMenu","e","onAddTabClick","onTabChange","activePath","localTabs","tabPairs","indexOf","tabValue","setTimeout","pair_base","tempActive","activeKeys","setNoTabs","closeAddTabMenu","onOverflowClick","handleOverflow","closeOverflowMenu","onSortItems","sortItems","sortedTabs","handleSearch","_","coins","result","toLowerCase","trim","fullname","cashName","pair_2","setItem","stringify","location","active","params","pathname","nextProps","activeLanguage","clearTimeout","tickers","obj","entries","forEach","symbols","TabList","tab","ticker","TAB_PLUS","ADD_TRADING_PAIR","DOUBLE_ARROW","mapStateToProps","store","app","language"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport ReactSVG from 'react-svg';\nimport { connect } from 'react-redux';\nimport classnames from 'classnames';\n\nimport Tab from './Tab';\nimport AddTabList from './AddTabList';\nimport TabOverflowList from './TabOverflowList';\nimport { DEFAULT_TRADING_PAIRS, DEFAULT_COIN_DATA } from '../../config/constants';\nimport { ICONS } from '../../config/constants';\nimport STRINGS from '../../config/localizedStrings';\n\nlet timeOut = '';\n\nclass PairTabs extends Component {\n    state = {\n        selectedTabs: {},\n        activeTabs: {},\n        activePairTab: '',\n        isAddTab: false,\n        selectedAddTab: '',\n        isTabOverflow: false,\n        searchValue: '',\n        searchResult: {},\n        selectedToRemove: '',\n        selectedToOpen: ''\n    };\n\n    componentDidMount() {\n        const { router, pairs, location } = this.props;\n        let active = '';\n        if (router && router.params.pair) {\n            let tabs = localStorage.getItem('tabs');\n            if (tabs !== null && tabs !== '' && !JSON.parse(tabs).length\n                && location.pathname.indexOf('/trade/') === 0) {\n                this.setNoTabs();\n            }\n            active = router.params.pair;\n            this.setState({ activePairTab: router.params.pair, selectedToOpen: router.params.pair });\n        } else {\n            active = '';\n            this.setState({ activePairTab: '' });\n        }\n        this.initTabs(pairs, active);\n    }\n\n    componentWillReceiveProps(nextProps) {\n        const { activePath, pairs, router, location } = nextProps;\n        let active = this.state.activePairTab;\n        let selectedToOpen = '';\n        if (this.props.activePath !== activePath) {\n            if (activePath !== 'trade') {\n                active = \"\";\n                this.setState({ activePairTab: '', selectedToOpen: '' });\n            }\n        }\n        if (JSON.stringify(this.props.pairs) !== JSON.stringify(pairs)) {\n            this.initTabs(pairs, active);\n        }\n        if (this.props.location && location\n            && this.props.location.pathname !== location.pathname) {\n            if (router && router.params.pair && location.pathname.indexOf('/trade/') === 0) {\n                active = router.params.pair;\n                if (!this.state.activeTabs[active]) {\n                    selectedToOpen = active;\n                }\n                this.setState({ activePairTab: router.params.pair, selectedToOpen });\n                let tabs = localStorage.getItem('tabs');\n                if (tabs !== null &&\n                    tabs !== '' &&\n                    !JSON.parse(tabs).length) {\n                    this.setNoTabs();\n                }\n            } else if (router && !router.params.pair) {\n                active = \"\";\n                this.setState({ activePairTab: '', selectedToOpen: '' });\n            }\n            this.initTabs(pairs, active);\n        }\n        if (this.props.activeLanguage !== nextProps.activeLanguage) {\n            this.initTabs(pairs, active);\n        }\n    }\n\n    componentWillUnmount() {\n        if (timeOut) {\n            clearTimeout(timeOut);\n        }\n    }\n\n\n    initTabs = (pairs, activePair) => {\n        let tabs = localStorage.getItem('tabs');\n        if (tabs === null || tabs === '') {\n            tabs = DEFAULT_TRADING_PAIRS;\n        } else if (tabs) {\n            tabs = JSON.parse(tabs);\n        } else {\n            tabs = [];\n        }\n        if (Object.keys(pairs).length) {\n            const tempTabs = {};\n            const selected = {};\n            if (activePair && !Object.keys(pairs).filter(value => value === activePair).length) {\n                this.props.router.push('/trade/add/tabs');\n            }\n            tabs.map((key, index) => {\n                if (pairs[key]) {\n                    if (index <= 3)\n                        tempTabs[key] = pairs[key];\n                    selected[key] = pairs[key];\n                }\n                return key;\n            });\n            if (activePair && !tempTabs[activePair] && tabs.length) {\n                const temp = pairs[activePair];\n                const pairKeys = Object.keys(tempTabs);\n                if (pairKeys.length < 4) {\n                    tempTabs[activePair] = temp;\n                } else {\n                    delete tempTabs[pairKeys[pairKeys.length - 1]];\n                    tempTabs[activePair] = temp;\n                }\n                if (!selected[activePair]) {\n                    selected[activePair] = temp;\n                }\n            }\n            this.setState({ selectedTabs: selected, activeTabs: tempTabs });\n            this.setTabsLocal(selected);\n        }\n    };\n\n    onTabClick = pair => {\n        if (pair) {\n            this.props.router.push(`/trade/${pair}`);\n            this.setState({ activePairTab: pair });\n        }\n    };\n\n    openAddTabMenu = e => {\n        this.setState({ isAddTab: !this.state.isAddTab, isTabOverflow: false });\n    };\n\n    onAddTabClick = pair => {\n        this.setState({ selectedAddTab: pair });\n    };\n\n    onTabChange = pair => {\n        const { selectedTabs, activeTabs, activePairTab, selectedToOpen } = this.state;\n        const { activePath, pairs } = this.props;\n        let localTabs = {};\n        let tabPairs = [];\n        if (selectedTabs[pair]) {\n            localTabs = { ...selectedTabs };\n            tabPairs = Object.keys(localTabs);\n            delete localTabs[pair];\n            this.setTabsLocal(localTabs);\n            if (activePairTab === pair || activePath !== 'trade') {\n                let index = tabPairs.indexOf(pair);\n                let tabValue = '';\n                if (index < (tabPairs.length - 1)) {\n                    tabValue = tabPairs[index + 1];\n                } else {\n                    tabValue = tabPairs[index - 1];\n                }\n                timeOut = setTimeout(() => {\n                    this.onTabClick(tabValue);\n                }, 300);\n            }\n            tabPairs = Object.keys(localTabs);\n            this.setState({ selectedTabs: { ...localTabs }, selectedToRemove: pair, selectedToOpen: '' });\n        } else {\n            const temp = pairs[pair];\n            if (temp && temp.pair_base) {\n                localTabs = { ...selectedTabs, [pair]: temp };\n                tabPairs = Object.keys(localTabs);\n                this.setState({ selectedTabs: { ...localTabs }, selectedToOpen: pair, selectedToRemove: '' });\n            }\n            this.setTabsLocal(localTabs);\n            this.onTabClick(pair);\n        }\n        if (activeTabs[pair]) {\n            let tempActive = {};\n            tabPairs.map((key, index) => {\n                if (index <= 3) {\n                    tempActive = { ...tempActive, [key]: localTabs[key] };\n                }\n                return key;\n            });\n            timeOut = setTimeout(() => {\n                this.setState({ activeTabs: { ...tempActive } });\n            }, 300);\n        } else if (!activeTabs[pair] && localTabs[pair]) {\n            let tempActive = activeTabs;\n            let activeKeys = Object.keys(activeTabs);\n            timeOut = setTimeout(() => {\n                if (tabPairs.length <= 4) {\n                    this.setState({ activeTabs: { ...localTabs } });\n                } else {\n                    delete tempActive[activeKeys[activeKeys.length - 1]];\n                    tempActive[pair] = localTabs[pair];\n                    this.setState({ activeTabs: { ...tempActive } });\n                }\n            }, 300);\n        }\n        if (!tabPairs.length) {\n            this.setNoTabs()\n        }\n        if (activeTabs[pair]\n            && pair !== activePairTab\n            && selectedToOpen === activePairTab) {\n            this.setState({ selectedToOpen: '' });\n        }\n        // this.setTabsLocal(localTabs);\n        this.closeAddTabMenu();\n    };\n\n    onOverflowClick = () => {\n        this.setState({ isTabOverflow: !this.state.isTabOverflow, isAddTab: false });\n    };\n\n    handleOverflow = pair => {\n        const { selectedTabs, activeTabs } = this.state;\n        if (!activeTabs[pair]) {\n            const tempTabs = { [pair]: selectedTabs[pair], ...activeTabs };\n            const pairs = Object.keys(tempTabs);\n            delete tempTabs[pairs[pairs.length - 1]];\n            this.setState({\n                activeTabs: { ...tempTabs },\n                selectedTabs: { ...tempTabs, ...this.state.selectedTabs }\n            });\n            this.setTabsLocal({ ...tempTabs, ...this.state.selectedTabs });\n        }\n        this.onTabClick(pair);\n        this.closeOverflowMenu();\n    };\n\n    closeAddTabMenu = () => {\n        this.setState({ isAddTab: false, searchValue: '', searchResult: {} });\n    };\n\n    closeOverflowMenu = () => {\n        this.setState({ isTabOverflow: false });\n    };\n\n    onSortItems = sortItems => {\n        const sortedTabs = {};\n        sortItems.map(pair => {\n            let temp = this.state.activeTabs[pair];\n            sortedTabs[pair] = temp;\n            return pair;\n        });\n        this.setTabsLocal({ ...sortedTabs, ...this.state.selectedTabs });\n        this.setState({ activeTabs: { ...sortedTabs }, selectedTabs: { ...sortedTabs, ...this.state.selectedTabs } });\n    };\n\n    handleSearch = (_, value) => {\n        const { pairs, coins } = this.props;\n        if (value) {\n            let result = {};\n            let searchValue = value.toLowerCase().trim();\n            Object.keys(pairs).map(key => {\n                let temp = pairs[key];\n                const { fullname } = coins[temp.pair_base.toLowerCase()] || DEFAULT_COIN_DATA;\n                let cashName = fullname ? fullname.toLowerCase() : '';\n                if (key.indexOf(searchValue) !== -1 ||\n                    temp.pair_base.indexOf(searchValue) !== -1 ||\n                    temp.pair_2.indexOf(searchValue) !== -1 ||\n                    cashName.indexOf(searchValue) !== -1) {\n                        result[key] = temp;\n                }\n                return key;\n            });\n            this.setState({ searchResult: { ...result }, searchValue: value });\n        } else {\n            this.setState({ searchResult: {}, searchValue: '' });\n        }\n    };\n\n    setTabsLocal = tabs => {\n        localStorage.setItem('tabs', JSON.stringify(Object.keys(tabs)));\n    };\n\n    setNoTabs = () => {\n        this.props.router.push('/account');\n    };\n\n    render() {\n        const { selectedTabs, isAddTab, selectedAddTab, activePairTab, isTabOverflow, activeTabs, searchValue, searchResult, selectedToOpen, selectedToRemove } = this.state;\n        const { pairs, tickers, location, coins } = this.props;\n        const obj = {};\n        Object.entries(pairs).forEach(([key, pair]) => {\n            obj[pair.pair_base] = '';\n        });\n        const symbols = Object.keys(obj).map((key) => key);\n        const TabList = Object.keys(activeTabs).map((tab, index) => {\n            const pair = activeTabs[tab];\n            const ticker = tickers[tab];\n            if (index <= 3) {\n                return (\n                    <Tab\n                        key={index}\n                        tab={tab}\n                        pair={pair}\n                        ticker={ticker}\n                        coins={coins}\n                        selectedToOpen={selectedToOpen}\n                        selectedToRemove={selectedToRemove}\n                        activePairTab={activePairTab}\n                        onSortItems={this.onSortItems}\n                        items={Object.keys(activeTabs)}\n                        sortId={index}\n                        onTabClick={this.onTabClick}\n                        onTabChange={this.onTabChange} />\n                )\n            }\n            return null;\n        })\n        return (\n            <div className=\"d-flex h-100\">\n                {TabList}\n                <div className={\n                    classnames(\n                        'app_bar-pair-content',\n                        'd-flex',\n                        'justify-content-between',\n                        'px-2',\n                        {\n                            'active-tab-pair': isAddTab || (location.pathname === '/trade/add/tabs' && !Object.keys(selectedTabs).length)\n                        })\n                    }>\n                    <div onClick={this.openAddTabMenu}>\n                        <ReactSVG path={ICONS.TAB_PLUS} wrapperClassName=\"app-bar-tab-close\" />\n                    </div>\n                    {Object.keys(selectedTabs).length <= 0 ?\n                        <span onClick={this.openAddTabMenu}>{STRINGS.ADD_TRADING_PAIR}</span>\n                    : '' }\n                    {isAddTab &&\n                        <AddTabList\n                            symbols={symbols}\n                            pairs={pairs}\n                            tickers={tickers}\n                            coins={coins}\n                            selectedTabs={selectedTabs}\n                            activeTabs={activeTabs}\n                            selectedTabMenu={selectedAddTab || symbols[0]}\n                            searchValue={searchValue}\n                            searchResult={searchResult}\n                            onAddTabClick={this.onAddTabClick}\n                            onTabChange={this.onTabChange}\n                            closeAddTabMenu={this.closeAddTabMenu}\n                            handleSearch={this.handleSearch}\n                        />\n                    }\n                </div>\n                {Object.keys(selectedTabs).length > 4\n                    && <div\n                        className={classnames('app_bar-pair-overflow', 'd-flex', 'align-items-center', { 'active-tab-overflow': isTabOverflow })}>\n                        <div onClick={this.onOverflowClick}>\n                            <ReactSVG path={ICONS.DOUBLE_ARROW} wrapperClassName=\"app-bar-tab-close\" />\n                        </div>\n                    {isTabOverflow\n                        && <TabOverflowList\n                            activeTabs={activeTabs}\n                            activePairTab={activePairTab}\n                            selectedTabs={selectedTabs}\n                            tickers={tickers}\n                            coins={coins}\n                            handleOverflow={this.handleOverflow}\n                            closeOverflowMenu={this.closeOverflowMenu}\n                        />\n                    }\n                </div>}\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = store => ({\n    activeLanguage: store.app.language,\n    pairs: store.app.pairs,\n    tickers: store.app.tickers,\n    coins: store.app.coins\n});\n\nexport default connect(mapStateToProps)(PairTabs);"]},"metadata":{},"sourceType":"module"}