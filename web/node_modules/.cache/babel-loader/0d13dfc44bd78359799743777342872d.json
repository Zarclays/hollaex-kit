{"ast":null,"code":"import _classCallCheck from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/Documents/projects/hollaex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/user/Documents/projects/hollaex/src/containers/UserSecurity/ApiKey.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { requestTokens, revokeToken, generateToken, tokenGenerated, tokenRevoked } from '../../actions/userAction';\nimport { Table, Dialog, Loader } from '../../components';\nimport { generateHeaders } from './ApiKeyHeaders';\nimport ApiKeyModal, { TYPE_GENERATE, TYPE_REVOKE } from './ApiKeyModal';\nimport { openContactForm } from '../../actions/appActions';\nimport { errorHandler } from '../../components/OtpForm/utils';\nimport { NoOtpEnabled, OtpEnabled } from './DeveloperSection';\nvar INITIAL_STATE = {\n  dialogIsOpen: false,\n  dialogType: '',\n  tokenId: -1\n};\n\nvar ApiKey =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ApiKey, _Component);\n\n  function ApiKey() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ApiKey);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ApiKey)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = INITIAL_STATE;\n\n    _this.requestTokens = function () {\n      _this.props.requestTokens();\n    };\n\n    _this.openDialog = function () {\n      _this.setState({\n        dialogIsOpen: true,\n        dialogType: TYPE_GENERATE\n      });\n    };\n\n    _this.onCloseDialog = function () {\n      _this.setState(INITIAL_STATE);\n    };\n\n    _this.onClickRevokeToken = function (tokenId) {\n      _this.setState({\n        dialogIsOpen: true,\n        dialogType: TYPE_REVOKE,\n        tokenId: tokenId\n      });\n    };\n\n    _this.onRevokeToken = function (otp_code) {\n      return revokeToken(_this.state.tokenId, otp_code).then(function (resp) {\n        var data = resp.data;\n\n        _this.props.tokenRevoked(data);\n\n        _this.onCloseDialog();\n      }).catch(errorHandler);\n    };\n\n    _this.onGenerateToken = function (otp_code, name) {\n      return generateToken({\n        otp_code: otp_code,\n        name: name\n      }).then(function (_ref) {\n        var data = _ref.data;\n\n        _this.props.tokenGenerated(data);\n\n        return data.token;\n      }).catch(errorHandler);\n    };\n\n    return _this;\n  }\n\n  _createClass(ApiKey, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.requestTokens();\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (!nextProps.submitting && nextProps.submitting !== this.props.submitting) {\n        this.onCloseDialog();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          tokens = _this$props.tokens,\n          openContactForm = _this$props.openContactForm,\n          fetching = _this$props.fetching,\n          otp_enabled = _this$props.otp_enabled,\n          openOtp = _this$props.openOtp,\n          activeTheme = _this$props.activeTheme;\n      var _this$state = this.state,\n          dialogIsOpen = _this$state.dialogIsOpen,\n          dialogType = _this$state.dialogType;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, otp_enabled ? React.createElement(OtpEnabled, {\n        fetching: fetching,\n        openDialog: this.openDialog,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }) : React.createElement(NoOtpEnabled, {\n        openOtp: openOtp,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, !fetching ? !otp_enabled && tokens.length === 0 ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }) : React.createElement(Table, {\n        rowClassName: \"pt-2 pb-2\",\n        headers: generateHeaders(this.onClickRevokeToken, otp_enabled),\n        data: tokens,\n        rowKey: function rowKey(data) {\n          return data.id;\n        },\n        count: tokens.length,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }) : otp_enabled && React.createElement(Loader, {\n        relative: true,\n        background: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      })), React.createElement(Dialog, {\n        isOpen: dialogIsOpen,\n        label: \"token-modal\",\n        theme: activeTheme,\n        onCloseDialog: this.onCloseDialog,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, React.createElement(ApiKeyModal, {\n        onCloseDialog: this.onCloseDialog,\n        notificationType: dialogType,\n        onGenerate: this.onGenerateToken,\n        onRevoke: this.onRevokeToken,\n        openContactForm: openContactForm,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return ApiKey;\n}(Component);\n\nApiKey.defaultProps = {\n  tokens: [],\n  openOtp: function openOtp() {},\n  generateKey: function generateKey() {}\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    tokens: state.user.tokens,\n    fetching: state.user.fetching,\n    error: state.user.error,\n    activeTheme: state.app.theme\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    openContactForm: bindActionCreators(openContactForm, dispatch),\n    requestTokens: bindActionCreators(requestTokens, dispatch),\n    tokenGenerated: bindActionCreators(tokenGenerated, dispatch),\n    tokenRevoked: bindActionCreators(tokenRevoked, dispatch)\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ApiKey);","map":{"version":3,"sources":["/home/user/Documents/projects/hollaex/src/containers/UserSecurity/ApiKey.js"],"names":["React","Component","connect","bindActionCreators","requestTokens","revokeToken","generateToken","tokenGenerated","tokenRevoked","Table","Dialog","Loader","generateHeaders","ApiKeyModal","TYPE_GENERATE","TYPE_REVOKE","openContactForm","errorHandler","NoOtpEnabled","OtpEnabled","INITIAL_STATE","dialogIsOpen","dialogType","tokenId","ApiKey","state","props","openDialog","setState","onCloseDialog","onClickRevokeToken","onRevokeToken","otp_code","then","resp","data","catch","onGenerateToken","name","token","nextProps","submitting","tokens","fetching","otp_enabled","openOtp","activeTheme","length","id","defaultProps","generateKey","mapStateToProps","user","error","app","theme","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport {\n\trequestTokens,\n\trevokeToken,\n\tgenerateToken,\n\ttokenGenerated,\n\ttokenRevoked\n} from '../../actions/userAction';\nimport { Table, Dialog, Loader } from '../../components';\nimport { generateHeaders } from './ApiKeyHeaders';\nimport ApiKeyModal, { TYPE_GENERATE, TYPE_REVOKE } from './ApiKeyModal';\nimport { openContactForm } from '../../actions/appActions';\nimport { errorHandler } from '../../components/OtpForm/utils';\nimport { NoOtpEnabled, OtpEnabled } from './DeveloperSection';\n\nconst INITIAL_STATE = {\n\tdialogIsOpen: false,\n\tdialogType: '',\n\ttokenId: -1\n};\nclass ApiKey extends Component {\n\tstate = INITIAL_STATE;\n\n\tcomponentDidMount() {\n\t\tthis.requestTokens();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tif (\n\t\t\t!nextProps.submitting &&\n\t\t\tnextProps.submitting !== this.props.submitting\n\t\t) {\n\t\t\tthis.onCloseDialog();\n\t\t}\n\t}\n\n\trequestTokens = () => {\n\t\tthis.props.requestTokens();\n\t};\n\n\topenDialog = () => {\n\t\tthis.setState({ dialogIsOpen: true, dialogType: TYPE_GENERATE });\n\t};\n\n\tonCloseDialog = () => {\n\t\tthis.setState(INITIAL_STATE);\n\t};\n\n\tonClickRevokeToken = (tokenId) => {\n\t\tthis.setState({ dialogIsOpen: true, dialogType: TYPE_REVOKE, tokenId });\n\t};\n\n\tonRevokeToken = (otp_code) => {\n\t\treturn revokeToken(this.state.tokenId, otp_code)\n\t\t\t.then((resp) => {\n\t\t\t\tconst { data } = resp;\n\t\t\t\tthis.props.tokenRevoked(data);\n\t\t\t\tthis.onCloseDialog();\n\t\t\t})\n\t\t\t.catch(errorHandler);\n\t};\n\n\tonGenerateToken = (otp_code, name) => {\n\t\treturn generateToken({ otp_code, name })\n\t\t\t.then(({ data }) => {\n\t\t\t\tthis.props.tokenGenerated(data);\n\t\t\t\treturn data.token;\n\t\t\t})\n\t\t\t.catch(errorHandler);\n\t};\n\n\trender() {\n\t\tconst {\n\t\t\ttokens,\n\t\t\topenContactForm,\n\t\t\tfetching,\n\t\t\totp_enabled,\n\t\t\topenOtp,\n\t\t\tactiveTheme\n\t\t} = this.props;\n\t\tconst { dialogIsOpen, dialogType } = this.state;\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{otp_enabled ? (\n\t\t\t\t\t<OtpEnabled fetching={fetching} openDialog={this.openDialog} />\n\t\t\t\t) : (\n\t\t\t\t\t<NoOtpEnabled openOtp={openOtp} />\n\t\t\t\t)}\n\t\t\t\t<div>\n\t\t\t\t\t{!fetching ? (\n\t\t\t\t\t\t!otp_enabled && tokens.length === 0 ? (\n\t\t\t\t\t\t\t<div />\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Table\n\t\t\t\t\t\t\t\trowClassName=\"pt-2 pb-2\"\n\t\t\t\t\t\t\t\theaders={generateHeaders(\n\t\t\t\t\t\t\t\t\tthis.onClickRevokeToken,\n\t\t\t\t\t\t\t\t\totp_enabled\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\tdata={tokens}\n\t\t\t\t\t\t\t\trowKey={(data) => {\n\t\t\t\t\t\t\t\t\treturn data.id;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tcount={tokens.length}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)\n\t\t\t\t\t) : (\n\t\t\t\t\t\totp_enabled && <Loader relative={true} background={false} />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<Dialog\n\t\t\t\t\tisOpen={dialogIsOpen}\n\t\t\t\t\tlabel=\"token-modal\"\n\t\t\t\t\ttheme={activeTheme}\n\t\t\t\t\tonCloseDialog={this.onCloseDialog}\n\t\t\t\t>\n\t\t\t\t\t<ApiKeyModal\n\t\t\t\t\t\tonCloseDialog={this.onCloseDialog}\n\t\t\t\t\t\tnotificationType={dialogType}\n\t\t\t\t\t\tonGenerate={this.onGenerateToken}\n\t\t\t\t\t\tonRevoke={this.onRevokeToken}\n\t\t\t\t\t\topenContactForm={openContactForm}\n\t\t\t\t\t/>\n\t\t\t\t</Dialog>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nApiKey.defaultProps = {\n\ttokens: [],\n\topenOtp: () => {},\n\tgenerateKey: () => {}\n};\n\nconst mapStateToProps = (state) => ({\n\ttokens: state.user.tokens,\n\tfetching: state.user.fetching,\n\terror: state.user.error,\n\tactiveTheme: state.app.theme\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n\topenContactForm: bindActionCreators(openContactForm, dispatch),\n\trequestTokens: bindActionCreators(requestTokens, dispatch),\n\ttokenGenerated: bindActionCreators(tokenGenerated, dispatch),\n\ttokenRevoked: bindActionCreators(tokenRevoked, dispatch)\n});\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchToProps\n)(ApiKey);\n"]},"metadata":{},"sourceType":"module"}